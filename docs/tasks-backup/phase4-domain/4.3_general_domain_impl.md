# PRD: General Domain 서비스 구현

## 1. 개요 (Overview)
- **Task ID**: 4.3_general_domain_impl
- **목표**: 자산, 물품, 총무 관리를 위한 지원 업무 로직을 구현합니다.
- **관련 로드맵**: Phase 4 - General Domain 서비스 병렬 개발

## 2. 상세 요구사항 (Requirements)

### 2.1 Asset Service (자산관리)
- [ ] **자산 등록**: 비품/장비 취득 정보 입력 및 자산번호 자동 부여
- [ ] **자산 변동**: 이동, 대여, 폐기 등 자산 상태 변경 이력 관리
- [ ] **감가상각**: 정액법/정률법 등 감가상각 자동 계산

### 2.2 Supply Service (물품관리)
- [ ] **물품 수급**: 구매 요청 및 입고/출고 처리
- [ ] **재고 관리**: 적정 재고 수준 모니터링 및 부족 알림
- [ ] **재고 실사**: 실사 결과 입력 및 차이 분석

### 2.3 General Affairs Service (총무관리)
- [ ] **차량 관리**: 법인 차량 배차 및 유류비 관리
- [ ] **행사 관리**: 사내 행사 일정 및 예산 관리
- [ ] **문서 관리**: 공문서 발송/접수 이력

## 3. 기술적 의사결정 (Technical Decisions)

### 3.1 자산 이력 추적
- **Event Sourcing 패턴 고려**: 자산 변동은 모두 이벤트로 기록하여 언제든 과거 상태 재구성 가능
- 또는 **Audit 테이블**: `AssetHistory` 테이블로 모든 변동 기록

### 3.2 재고 알림
- 재고가 최소 수량 이하로 떨어지면 **이벤트 발행** → `notification-service`가 담당자에게 알림 전송

## 4. 작업 단위 (Work Breakdown)

1.  **Prisma Schema 설계**:
    - Asset, Inventory, Vehicle 등 테이블 설계
    - AssetHistory 테이블로 변동 이력 기록

2.  **Asset Service 구현**:
    - 감가상각 계산 로직
    - 자산 변동 이력 관리

3.  **Supply Service 구현**:
    - 재고 입출고 트랜잭션 처리
    - 재고 알림 이벤트 발행

4.  **General Affairs Service 구현**:
    - 차량 배차 스케줄링 로직
    - 중복 배차 방지

5.  **Docker Compose에서 테스트**:
    ```bash
    # General 서비스 실행
    cd dev-environment
    docker compose -f docker-compose.infra.yml -f docker-compose.dev.yml up -d \
      asset-service supply-service general-affairs-service
    
    # 자산 등록 테스트
    curl -X POST http://localhost:3031/api/assets \
      -H "Content-Type: application/json" \
      -d '{"name":"노트북","category":"전산장비"}'
    
    # Swagger UI
    open http://localhost:3031/api  # Asset
    open http://localhost:3032/api  # Supply
    open http://localhost:3033/api  # General Affairs
    ```

> **참고**: [Docker-First Workflow Guide](../../guides/docker-first-workflow.md)

## 5. 승인 기준 (Acceptance Criteria)
- [ ] **자산 이력**: Docker Compose 환경에서 자산 이력 조회 시 모든 변동 내역 시간순 표시
- [ ] **재고 검증**: 재고 출고 시 재고가 음수가 되지 않도록 검증
- [ ] **배차 관리**: 차량 배차 시 중복 배차 불가능
- [ ] **Swagger UI**: 각 서비스의 Swagger UI에서 API 테스트 가능
