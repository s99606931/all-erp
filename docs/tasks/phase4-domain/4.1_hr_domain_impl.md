# PRD: HR Domain 서비스 구현

## 1. 개요 (Overview)
- **Task ID**: 4.1_hr_domain_impl
- **목표**: 인사, 급여, 복무 관리를 위한 핵심 비즈니스 로직을 구현합니다.
- **관련 로드맵**: Phase 4 - HR Domain 서비스 병렬 개발

## 2. 상세 요구사항 (Requirements)

### 2.1 Personnel Service (인사관리)
- [ ] **인사 카드**: 직원 기본정보 CRUD
- [ ] **발령 관리**: 신규입사, 전보, 승진, 퇴사 등 인사발령 처리
- [ ] **제증명 발급**: 재직증명서, 경력증명서 자동 생성 및 출력

### 2.2 Payroll Service (급여관리)
- [ ] **급여 계산**: 기본급, 수당, 공제 항목 계산 엔진
- [ ] **급여 대장**: 월별 급여 명세서 생성 및 조회
- [ ] **연말정산**: 소득공제 항목 관리 및 원천징수영수증 발급

### 2.3 Attendance Service (복무관리)
- [ ] **근태 관리**: 출퇴근 기록, 지각/조퇴/결근 처리
- [ ] **휴가 관리**: 연차/반차/병가 신청 및 승인 워크플로우
- [ ] **출장 관리**: 출장 신청/정산

## 3. 기술적 의사결정 (Technical Decisions)

### 3.1 DB 스키마 설계
- **정규화**: 3NF 이상으로 데이터 중복 최소화
- **감사(Audit) 컬럼**: `createdAt`, `updatedAt`, `createdBy`, `updatedBy` 필수 포함
- **소프트 삭제**: 물리적 삭제 대신 `deletedAt` 컬럼을 활용한 논리적 삭제

### 3.2 급여 계산 로직
- **✅ 권장사항**: 급여 계산은 **복잡한 비즈니스 규칙**이므로, 별도의 `PayrollCalculator` 클래스로 분리하여 단위 테스트 작성
- **금액 처리**: `Decimal` 타입 사용 (부동소수점 오차 방지)

### 3.3 서비스 간 데이터 참조
- 급여 계산 시 근태 정보 필요 → `attendance-service` API 호출 또는 **Event-driven** 방식 (근태 확정 시 이벤트 발행)

## 4. 작업 단위 (Work Breakdown)
1.  각 서비스별 Prisma Schema 설계 (ERD 작성 권장)
2.  `personnel-service`: Entity, Repository, Service, Controller 구현
3.  `payroll-service`: 급여 계산 로직 구현 및 테스트
4.  `attendance-service`: 휴가 잔여일수 자동 계산 로직 구현
5.  API 문서화 (Swagger)

## 5. 승인 기준 (Acceptance Criteria)
- [ ] 인사 카드 CRUD API가 정상 동작해야 한다.
- [ ] 급여 계산 결과가 실제 급여 규정과 일치해야 한다 (단위 테스트로 검증).
- [ ] 휴가 신청 시 잔여 연차가 정확히 차감되어야 한다.
