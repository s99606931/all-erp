# PRD: API Gateway 및 네트워크 설정

## 1. 개요 (Overview)
- **Task ID**: 2.3_api_gateway
- **목표**: 마이크로서비스의 단일 진입점(Entry Point)을 제공하고, 라우팅 및 기본 로드밸런싱을 수행하는 게이트웨이를 구축합니다.
- **관련 로드맵**: Phase 2 - 게이트웨이 및 네트워크

## 2. 상세 요구사항 (Requirements)
- [ ] **라우팅 설정**: URL Path에 따라 적절한 마이크로서비스로 요청 전달
    - `/api/auth/*` -> `auth-service`
    - `/api/hr/*` -> `personnel-service` 등
- [ ] **CORS 설정**: 프론트엔드 도메인에서의 요청 허용

## 3. 기술적 의사결정 (Technical Decisions)

### 3.1 Gateway 솔루션
- **선택지 A**: **Nginx** (Reverse Proxy)
    - 장점: 가볍고 설정이 간단함. 정적 파일 서빙 가능.
    - 단점: 동적 설정 변경이 어려움.
- **선택지 B**: **Kong / APISIX** (API Gateway)
    - 장점: 플러그인(인증, Rate Limiting) 풍부, 동적 설정 가능.
    - 단점: 운영 복잡도 있음.
- **선택지 C**: **Spring Cloud Gateway** (Java 기반)
    - 단점: Node.js 스택과 이질적임.
- **✅ 권장사항**: **`Nginx` (초기) -> `Kong` (고도화)**
    - **이유**: 초기 단계에서는 구조가 단순하므로 Nginx로 빠르게 구성을 잡고, 추후 트래픽 제어나 정교한 인증이 필요할 때 Kong으로 전환합니다.

## 4. 작업 단위 (Work Breakdown)

> **참고**: API Gateway(Nginx)는 이미 `dev-environment/docker-compose.devops.yml`에 정의되어 있습니다.
> 현재 포트: 80 (HTTP), 443 (HTTPS)

1.  **Nginx 설정 파일 작성**:
    - `dev-environment/config/nginx/nginx.conf` 파일에 라우팅 규칙 정의
    - 예시:
    ```nginx
    upstream auth_service {
        server auth-service:3001;
    }
    
    server {
        listen 80;
        
        location /api/auth/ {
            proxy_pass http://auth_service/;
        }
    }
    ```

2.  **Docker Compose로 Gateway 실행**:
    ```bash
    cd dev-environment
    docker compose -f docker-compose.devops.yml up -d gateway
    ```

3.  **로컬 테스트**:
    ```bash
    # Gateway를 통한 접근 테스트
    curl http://localhost/api/auth/health
    ```

> **참고**: [Docker-First Workflow Guide](../../guides/docker-first-workflow.md)

## 5. 승인 기준 (Acceptance Criteria)
- [ ] **Gateway 통한 API 호출**: 게이트웨이 포트(80/443)를 통해 각 마이크로서비스 API 호출 가능
- [ ] **CORS 설정**: CORS 에러 없이 프론트엔드에서 API 호출 가능
- [ ] **로드밸런싱**: 동일 서비스의 여러 인스턴스에 대한 부하 분산 (추후 확장)
