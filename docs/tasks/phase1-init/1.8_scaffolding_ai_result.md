# Phase 1.8 AI Domain ì„œë¹„ìŠ¤ ìŠ¤ìºí´ë”© ì‘ì—… ì™„ë£Œ ë³´ê³ ì„œ

**ì‘ì—… ID**: 1.8_scaffolding_ai  
**ì‘ì—… ê¸°ê°„**: 2025-12-02  
**ì‘ì—… ìƒíƒœ**: âœ… ì™„ë£Œ

---

## 1. ì‘ì—… ê°œìš”

AI ê¸°ëŠ¥ì„ ì „ë‹´í•  `ai-service`ë¥¼ NestJS ê¸°ë°˜ìœ¼ë¡œ ìŠ¤ìºí´ë”©í•˜ê³ , Vector DB(Milvus) ì—°ë™ì„ ìœ„í•œ í™˜ê²½ ì„¤ì •ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. Docker Compose í™˜ê²½ì—ì„œ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

## 2. ì™„ë£Œëœ ì„œë¹„ìŠ¤

### 2.1 AI Service (AI ê¸°ëŠ¥ ë° LLM ì—°ë™)
- **ìœ„ì¹˜**: `apps/ai/ai-service`
- **í¬íŠ¸**: 3007
- **Health Check**: âœ… `http://localhost:3007/api/health`
- **Swagger UI**: âœ… `http://localhost:3007/api`
- **Container**: `all-erp-ai-service-dev`
- **ì£¼ìš” ê¸°ëŠ¥**:
  - LangChain.js ê¸°ë°˜ LLM ì—°ë™ ì¤€ë¹„
  - Milvus Vector DB ì—°ë™ ì§€ì›
  - Swagger API ë¬¸ì„œí™”
  - Health Check ì—”ë“œí¬ì¸íŠ¸

## 3. ê¸°ìˆ  ìŠ¤íƒ

```mermaid
graph TB
    subgraph "Container Runtime"
        Docker["Docker ğŸ³"]
        Compose["Docker Compose"]
    end
    
    subgraph "Application"
        NestJS["NestJS Framework"]
        Nx["Nx Monorepo"]
        Node["Node.js 22 Alpine"]
    end
    
    subgraph "Libraries"
        Swagger["@nestjs/swagger"]
        Validator["class-validator"]
        Config["@all-erp/shared/config"]
    end
    
    subgraph "AI Infrastructure"
        Milvus["Milvus Vector DB"]
        LangChain["LangChain.js (ì¤€ë¹„)"]
    end
    
    Docker --> Compose
    Compose --> Node
    Node --> Nx
    Nx --> NestJS
    NestJS --> Swagger
    NestJS --> Validator
    NestJS --> Config
    NestJS -.-> LangChain
    NestJS --> Milvus
```

## 4. Docker Compose êµ¬ì„±

### 4.1 ì‹¤í–‰ ëª…ë ¹ì–´
```bash
cd dev-environment
docker compose -f docker-compose.infra.yml -f docker-compose.dev.yml up -d ai-service
```

### 4.2 ì„œë¹„ìŠ¤ êµ¬ì„±

```yaml
# docker-compose.dev.yml
  ai-service:
    ports:
      - "3007:3007"
      - "9241:9229"  # Debug
    environment:
      # Vector DB (Milvus) ì„¤ì •
      MILVUS_HOST: milvus
      MILVUS_PORT: 19530
    volumes:
      - ../apps:/workspace/apps:cached
      - ../libs:/workspace/libs:cached
    command: pnpm nx serve ai-service --host=0.0.0.0
    networks:
      - all-erp-network
```

### 4.3 Hot Reload ì§€ì›
- âœ… ë¡œì»¬ `apps/`, `libs/` ë””ë ‰í† ë¦¬ë¥¼ ë³¼ë¥¨ ë§ˆìš´íŠ¸
- âœ… Nx watch modeë¡œ ìë™ ì¬ì»´íŒŒì¼
- âœ… ì½”ë“œ ìˆ˜ì • ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ìë™ ë°˜ì˜

### 4.4 Milvus Vector DB ì—°ë™
- âœ… `docker-compose.infra.yml`ì— Milvus ì„œë¹„ìŠ¤ ì¡´ì¬
- âœ… í™˜ê²½ë³€ìˆ˜ë¡œ Milvus ì ‘ì† ì •ë³´ ì£¼ì…
- âœ… AI ì„œë¹„ìŠ¤ì—ì„œ ë²¡í„° ì„ë² ë”© ì €ì¥/ê²€ìƒ‰ ê°€ëŠ¥

## 5. ê²€ì¦ ê²°ê³¼

### 5.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```bash
$ pnpm nx test ai-service
PASS   ai-service  apps/ai/ai-service/src/app/app.controller.spec.ts
Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
```

### 5.2 Swagger UI
- âœ… AI Service: `http://localhost:3007/api`

### 5.3 ì»¨í…Œì´ë„ˆ ìƒíƒœ
```bash
$ docker compose ps
NAME                        STATUS
all-erp-ai-service-dev      Up
all-erp-milvus              Up  (Vector DB)
```

## 6. íŒŒì¼ ë³€ê²½ ì‚¬í•­

### 6.1 ìƒì„±ëœ íŒŒì¼
- `apps/ai/ai-service/`
  - `src/main.ts`: Swagger, ValidationPipe, Port(3007) ì„¤ì •
  - `src/app/app.controller.ts`: ê¸°ë³¸ API ì»¨íŠ¸ë¡¤ëŸ¬ (í•œêµ­ì–´ ì£¼ì„ í¬í•¨)
  - `src/app/app.service.ts`: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬ (í•œêµ­ì–´ ì£¼ì„ í¬í•¨)
  - `project.json`: test íƒ€ê²Ÿ ì¶”ê°€
  - `jest.config.ts`: í…ŒìŠ¤íŠ¸ ì„¤ì •
  - `tsconfig.spec.json`: í…ŒìŠ¤íŠ¸ TypeScript ì„¤ì •
- `apps/ai/ai-service-e2e/`: E2E í…ŒìŠ¤íŠ¸ íŒŒì¼

### 6.2 ìˆ˜ì •ëœ íŒŒì¼
- [dev-environment/docker-compose.dev.yml](file:///data/all-erp/dev-environment/docker-compose.dev.yml)
  - ai-service ì •ì˜ ì¶”ê°€
  - Milvus í™˜ê²½ë³€ìˆ˜ ì„¤ì •

## 7. ìŠ¹ì¸ ê¸°ì¤€ ë‹¬ì„± ì—¬ë¶€

| ìŠ¹ì¸ ê¸°ì¤€ | ìƒíƒœ | ë¹„ê³  |
|---------|------|-----|
| Docker Composeë¡œ ì„œë¹„ìŠ¤ ì‹œì‘ | âœ… | `docker compose up -d` ì„±ê³µ |
| Swagger UI í™•ì¸ | âœ… | `/api` ì ‘ì† ê°€ëŠ¥ |
| Health Check í™•ì¸ | âœ… | `/api/health` ì •ìƒ ì‘ë‹µ |

## 8. ë‹¤ìŒ ë‹¨ê³„

Phase 1.8ì´ ì™„ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ, ë‹¤ìŒ ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **AI ê¸°ëŠ¥ êµ¬í˜„**
   - LangChain.js ì„¤ì¹˜ ë° LLM ì—°ë™
   - Vector DB(Milvus) ì—°ë™ êµ¬í˜„
   - RAG(Retrieval Augmented Generation) êµ¬ì¶•

2. **AI í™œìš© ì‹œë‚˜ë¦¬ì˜¤**
   - OCR ê¸°ë°˜ ìë™ ë¶„ê°œ ì²˜ë¦¬
   - ë¬¸ì„œ ê¸°ë°˜ ì±—ë´‡ (RAG)
   - ì´ìƒ ê±°ë˜ íƒì§€

## 9. ì°¸ê³  ë¬¸ì„œ

- [PRD: 1.8_scaffolding_ai.md](file:///data/all-erp/docs/tasks/phase1-init/1.8_scaffolding_ai.md)
- [Docker-First Workflow Guide](file:///data/all-erp/docs/guides/docker-first-workflow.md)

---

**ì‘ì„±ì¼**: 2025-12-02  
**ì‘ì„±ì**: AI Development Team
