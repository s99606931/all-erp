# PRD: 환경 변수 관리 전략 수립

## 1. 개요 (Overview)
- **Task ID**: 1.2_env_strategy
- **목표**: 개발, 테스트, 운영 환경별로 상이한 설정값(DB 접속 정보, API 키 등)을 안전하고 효율적으로 관리하기 위한 전략을 수립합니다.
- **관련 로드맵**: Phase 1 - 환경 변수 관리 전략 수립

## 2. 상세 요구사항 (Requirements)
- [ ] **.env 파일 구조 정의**: 로컬 개발용(`.env.local`), 템플릿(`.env.example`) 파일 규칙 정의
- [ ] **Git Ignore 설정**: 민감한 정보가 담긴 `.env` 파일이 저장소에 올라가지 않도록 설정
- [ ] **유효성 검사**: 애플리케이션 시작 시 필수 환경 변수 누락 여부를 검사하는 메커니즘 마련 (Joi/Zod 활용)

## 3. 기술적 의사결정 (Technical Decisions)

### 3.1 라이브러리 선택
- **선택지 A**: `dotenv` (Node.js 기본)
- **선택지 B**: `@nestjs/config` (NestJS 공식)
- **✅ 권장사항**: **`@nestjs/config`**
    - **이유**: NestJS 환경에서 `dotenv`를 내부적으로 사용하며, 의존성 주입(DI), 유효성 검사(Joi), 네임스페이스 등 강력한 기능을 제공합니다.

### 3.2 Secret 관리 (Production)
- **선택지 A**: GitHub Secrets / CI/CD Variable
- **선택지 B**: AWS Parameter Store / Secrets Manager
- **선택지 C**: HashiCorp Vault
- **✅ 권장사항**: **`GitHub Secrets` (초기) -> `AWS Secrets Manager` (운영)**
    - **이유**: 초기 단계에서는 GitHub Actions와 연동이 쉬운 GitHub Secrets로 시작하고, 운영 단계에서 보안 요구사항이 높아지면 전용 Secret Manager로 이관합니다.

## 4. 작업 단위 (Work Breakdown)
1.  루트 디렉토리에 `.env.example` 생성 (모든 서비스 공통 변수 및 서비스별 변수 템플릿)
2.  `.gitignore`에 `.env`, `.env.*` (단, `.env.example` 제외) 추가
3.  `libs/shared/config` 라이브러리 생성하여 환경 변수 유효성 검사 로직(Joi/Zod) 공통화

## 5. 승인 기준 (Acceptance Criteria)
- [ ] `.env` 파일이 Git에 커밋되지 않아야 한다.
- [ ] `.env.example` 파일만 보고도 개발자가 로컬 환경을 세팅할 수 있어야 한다.
- [ ] 필수 환경 변수가 없을 경우 앱 실행 시 명확한 에러 메시지를 출력하고 종료되어야 한다.
