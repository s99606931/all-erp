# [Development] personnel-service Dockerfile
# Context must be project root
FROM node:22-slim

WORKDIR /workspace

# Install system dependencies (Prisma, etc)
RUN apt-get update && \
    apt-get install -y openssl libssl-dev ca-certificates && \
    rm -rf /var/lib/apt/lists/*

# Install pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

# Copy monorepo configs (Context Root)
COPY package.json pnpm-lock.yaml ./
COPY nx.json tsconfig.base.json ./
COPY prisma.config.ts ./
# Prisma configs might be needed if postinstall runs generate
COPY libs/shared/infra/prisma ./libs/shared/infra/prisma
# Service specific schema if exists (handled by volume usually, but good for caching)

# Install dependencies
RUN pnpm install --frozen-lockfile

# Source code is mounted via Volumes in docker-compose
CMD ["sh", "-c", "echo 'Use docker-compose command'"]
